# Описание бота

## Основной функционал
1. **Управление пользователями**
   - Регистрация и управление профилями пользователей
   - Реферальная система с отслеживанием приглашенных пользователей
   - Управление балансом пользователей
   - Управление премиум-подписками

2. **Интеграция платежных систем**
   - Поддержка нескольких платежных провайдеров:
     - Cryptomus (криптовалютные платежи)
     - MulenPay
     - Heleket
   - Функционал пополнения баланса
   - Отслеживание истории транзакций

3. **Интеграция с Fragment API**
   - Система покупки звезд
   - Активация премиум-подписки
   - Аутентификация через JWT токен
   - API эндпоинты:
     - `/v1/auth/authenticate/` - Аутентификация
     - `/v1/order/stars/` - Покупка звезд
     - `/v1/order/premium/` - Активация премиума

## Премиум функции
1. **Тарифные планы**
   - 3 месяца (799)
   - 6 месяцев (1499)
   - 12 месяцев (2499)

2. **Система звезд**
   - Множество вариантов пакетов звезд:
     - Малые пакеты: 50, 75, 100, 150, 250
     - Средние пакеты: 350, 500, 750, 1000, 1500
     - Большие пакеты: 2500, 5000, 10000, 25000, 35000
     - Премиум пакеты: 50000, 100000, 150000, 500000, 1000000
   - Цена за звезду: 1.8

## Функции админ-панели
1. **Управление пользователями**
   - Просмотр профилей пользователей
   - Управление балансами пользователей
   - Отслеживание реферальных связей
   - Мониторинг премиум-подписок

2. **Управление транзакциями**
   - Просмотр истории платежей
   - Отслеживание покупок звезд
   - Мониторинг активаций премиума
   - Обработка возвратов при необходимости

3. **Конфигурация системы**
   - Управление настройками платежных провайдеров
   - Настройка учетных данных Fragment API
   - Настройка промо-кампаний
   - Мониторинг состояния системы

## Настройка окружения
Необходимые переменные окружения:
```
# Конфигурация бота
BOT_TOKEN=ваш_токен_бота
ADMIN_ID=ваш_id_админа

# База данных
POSTGRES_DSN=ваша_строка_подключения_postgres
REDIS_URL=ваш_url_redis

# Fragment API
FRAGMENT_API_KEY=ваш_api_ключ
FRAGMENT_SHOP_ID=ваш_id_магазина
FRAGMENT_PHONE_NUMBER=ваш_номер_телефона
FRAGMENT_MNEMONICS=ваши_мнемоники
FRAGMENT_JWT_TOKEN=ваш_jwt_токен

# Платежные системы
CRYPTOMUS_API_KEY=ваш_ключ
CRYPTOMUS_MERCHANT_ID=ваш_id_мерчанта
CRYPTOMUS_WEBHOOK_SECRET=ваш_секрет_вебхука

MULENPAY_API_KEY=ваш_ключ
MULENPAY_SECRET_KEY=ваш_секретный_ключ
MULENPAY_SHOP_ID=ваш_id_магазина
MULENPAY_MERCHANT_ID=ваш_id_мерчанта
MULENPAY_WEBHOOK_SECRET=ваш_секрет_вебхука
MULENPAY_CALLBACK_URL=ваш_url_обратного_вызова

HELEKET_API_KEY=ваш_ключ
HELEKET_MERCHANT_ID=ваш_id_мерчанта
HELEKET_CALLBACK_URL=ваш_url_обратного_вызова

# Другие настройки
NEWS_CHANNEL_ID=ваш_id_канала
NEWS_CHANNEL_LINK=ваша_ссылка_на_канал
WELCOME_IMAGE_URL=ваше_приветственное_изображение
WELCOME_DESCRIPTION=ваш_приветственный_текст
PROFILE_OFFER_URL=ваша_ссылка_на_оферту
PROFILE_PRIVACY_URL=ваша_ссылка_на_политику_конфиденциальности
SUPPORT_URL=ваша_ссылка_на_поддержку
```

## Детали интеграции с Fragment API
1. **Аутентификация**
   - Использует JWT токен для аутентификации
   - Кэширование токена с автоматическим обновлением
   - Необходимые учетные данные:
     - API Ключ
     - Номер телефона
     - Мнемоники

2. **API эндпоинты**
   - Покупка звезд:
     ```python
     url = "https://api.fragment-api.com/v1/order/stars/"
     data = {
         "username": username,
         "quantity": quantity,
         "show_sender": False
     }
     ```
   - Активация премиума:
     ```python
     url = "https://api.fragment-api.com/v1/order/premium/"
     data = {
         "username": username,
         "months": months
     }
     ```

3. **Обработка ошибок**
   - Механизм автоматических повторных попыток
   - Обновление токена при истечении срока действия
   - Логирование и мониторинг ошибок

## Инструкция по получению JWT токена Fragment API
1. Создайте файл `.env` с необходимыми переменными:
   ```
   FRAGMENT_API_KEY=ваш_api_ключ
   FRAGMENT_PHONE_NUMBER=ваш_номер_телефона
   FRAGMENT_MNEMONICS=ваши_мнемоники
   ```

2. Запустите скрипт `fragment_get_token.py`:
   ```bash
   python fragment_get_token.py
   ```

3. Скрипт автоматически:
   - Получит JWT токен
   - Добавит его в файл `.env` как `FRAGMENT_JWT_TOKEN`
   - Выведет токен в консоль

## Ссылки на платежные системы
- Cryptomus: https://cryptomus.com/
- MulenPay: https://mulenpay.com/
- Heleket: https://heleket.com/

## Документация Fragment API
- Официальная документация: https://api.fragment-api.com/docs/
- API Endpoints: https://api.fragment-api.com/v1/

## Автор и поддержка
Автор: [Ваше имя]
Поддержка автора:
- USDT TRC-20: [Ваш адрес кошелька]
- Другие способы поддержки: [Дополнительная информация]

## Обратная связь и помощь
Если у вас есть предложения по улучшению бота или вы нашли ошибку — пишите в Telegram: [ваш Telegram-ник]

Помощь с установкой бота на сервер или хостинг — 10$. 